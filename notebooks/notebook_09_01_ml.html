<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matt Lawrence">
<meta name="dcterms.date" content="2023-11-07">

<title>Tests of Association</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="notebook_09_01_ml_files/libs/clipboard/clipboard.min.js"></script>
<script src="notebook_09_01_ml_files/libs/quarto-html/quarto.js"></script>
<script src="notebook_09_01_ml_files/libs/quarto-html/popper.min.js"></script>
<script src="notebook_09_01_ml_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="notebook_09_01_ml_files/libs/quarto-html/anchor.min.js"></script>
<link href="notebook_09_01_ml_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="notebook_09_01_ml_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="notebook_09_01_ml_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="notebook_09_01_ml_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="notebook_09_01_ml_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tests of Association</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Matt Lawrence </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 7, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="setting-up" class="level2">
<h2 class="anchored" data-anchor-id="setting-up">Setting Up</h2>
<p>We’ll make our own data today so there’s not a file to load. Still load the usual packages though.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our data will come from the crosstabs released by <em>The New York Times</em> for <a href="https://www.nytimes.com/2023/11/05/us/politics/biden-trump-2024-poll.html">this article</a>. The data can be accessed <a href="https://www.nytimes.com/interactive/2023/11/07/us/elections/times-siena-battlegrounds-registered-voters.html">here</a>. We’ll use the “Battleground All Registered Voters” numbers.</p>
</section>
<section id="introducing-association" class="level2">
<h2 class="anchored" data-anchor-id="introducing-association">Introducing Association</h2>
<p>Two variables have a <em>dependent association</em> if knowing value of one variable helps predict value of the other variable. Two variables have an <em>independent association</em> if knowing value of one variable does not help predict value of the other variable.</p>
<p>In our first example, we want to know if there is a statistically significant dependent association between age category and candidate preference. Here is the distribution using the percentages in the crosstabs:</p>
<table class="table">
<thead>
<tr class="header">
<th>Age</th>
<th style="text-align: center;">Biden</th>
<th style="text-align: center;">Trump</th>
<th style="text-align: center;">Other/DK</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>18-29</td>
<td style="text-align: center;">47%</td>
<td style="text-align: center;">46%</td>
<td style="text-align: center;">7%</td>
</tr>
<tr class="even">
<td>30-44</td>
<td style="text-align: center;">43%</td>
<td style="text-align: center;">47%</td>
<td style="text-align: center;">10%</td>
</tr>
<tr class="odd">
<td>45-64</td>
<td style="text-align: center;">42%</td>
<td style="text-align: center;">52%</td>
<td style="text-align: center;">6%</td>
</tr>
<tr class="even">
<td>65+</td>
<td style="text-align: center;">46%</td>
<td style="text-align: center;">46%</td>
<td style="text-align: center;">7%</td>
</tr>
</tbody>
</table>
<p>We need to get this data into R. And we need frequencies rather than percentages.</p>
<p>We’ll set this up by creating a row for each age group (so we’ll be “transposing”) the format of the original table.</p>
<p>Here’s the first row. Note we use proportions, collapse all the “other” responses, and multiply the proportions by the number of respondents to get the frequencies:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>age_18_29 <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">47</span>, .<span class="dv">46</span>, .<span class="dv">07</span>)<span class="sc">*</span><span class="dv">646</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in the rest of the rows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>age_30_44 <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">43</span>, .<span class="dv">47</span>, .<span class="dv">10</span>)<span class="sc">*</span><span class="dv">868</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>age_45_64 <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">42</span>, .<span class="dv">52</span>, .<span class="dv">06</span>)<span class="sc">*</span><span class="dv">1234</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>age_65_plus <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">46</span>, .<span class="dv">46</span>, .<span class="dv">07</span>)<span class="sc">*</span><span class="dv">793</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next step is to “bind the rows” together in a table. We will use the <code>rbind</code> function - r for rows - for this task. We can name the table anything. Calling it “observed_table” here will be helpful for explaining how these tests work.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>observed_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(age_18_29,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                       age_30_44,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                       age_45_64,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                       age_65_plus)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>observed_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]   [,2]  [,3]
age_18_29   303.62 297.16 45.22
age_30_44   373.24 407.96 86.80
age_45_64   518.28 641.68 74.04
age_65_plus 364.78 364.78 55.51</code></pre>
</div>
</div>
<p>There is some rounding going on here. We should use whole numbers. Round to 0 decimal places to get them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>observed_table <span class="ot">&lt;-</span> <span class="fu">round</span>(observed_table, <span class="dv">0</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>observed_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1] [,2] [,3]
age_18_29    304  297   45
age_30_44    373  408   87
age_45_64    518  642   74
age_65_plus  365  365   56</code></pre>
</div>
</div>
<p>It would be good to add column names as well. We can do that with the <code>colnames = c()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(observed_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"biden"</span>, <span class="st">"trump"</span>, <span class="st">"other"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, get the sums of the rows, columns, and full table with <code>addmargins()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(observed_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            biden trump other  Sum
age_18_29     304   297    45  646
age_30_44     373   408    87  868
age_45_64     518   642    74 1234
age_65_plus   365   365    56  786
Sum          1560  1712   262 3534</code></pre>
</div>
</div>
<p>We will use the chi-squared test of independence to test whether or not we can reject the null hypothesis that there is no association between the two variables. The test statistic is:</p>
<p><span class="math inline">\(\Large{x^2 = \sum {\frac {(f_o - f_e)^2} {f_e}}}\)</span></p>
<p>To calculate the test statistic, we need the observed frequencies and the expected frequencies. We just saw the observed frequencies.</p>
<p>The expected value of each cell is defined as: (total in row * total in column) / (total in table)</p>
<p>What is the expected value for the “age_18_29, Biden” cell?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">646</span> <span class="sc">*</span> <span class="dv">1560</span>) <span class="sc">/</span> <span class="dv">3534</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 285.1613</code></pre>
</div>
</div>
<p>For the test statistic, we need the expected values in every cell. For now, calculate them for the other two columns in the first row…</p>
<section id="replace-this-line-with-your-code" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For age_18_29, Trump</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">646</span><span class="sc">*</span><span class="dv">1712</span>) <span class="sc">/</span> <span class="dv">3534</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 312.9462</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For age_18_29, Other</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">646</span><span class="sc">*</span><span class="dv">262</span>) <span class="sc">/</span> <span class="dv">3534</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47.89247</code></pre>
</div>
</div>
<p>To do the chi-squared test by hand, we will need a table with all the expected frequencies. We just did the age_18_29 row; here are those frequencies saved as a vector, a separate vector for each additional age, and the code to make the table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>expected_age_18_29 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">285.1613</span>, <span class="fl">312.9462</span>, <span class="fl">47.8925</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>expected_age_30_44 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">383.1579</span>, <span class="fl">420.4912</span>, <span class="fl">64.3509</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>expected_age_45_64 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">544.7199</span>, <span class="fl">597.7951</span>, <span class="fl">91.4850</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>expected_age_65_plus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">346.9610</span>, <span class="fl">380.7674</span>, <span class="fl">58.2717</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>expected_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(expected_age_18_29,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                        expected_age_30_44,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                        expected_age_45_64,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                        expected_age_65_plus)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(expected_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"biden"</span>, <span class="st">"trump"</span>, <span class="st">"other"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take a look at the table of expected values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>expected_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        biden    trump   other
expected_age_18_29   285.1613 312.9462 47.8925
expected_age_30_44   383.1579 420.4912 64.3509
expected_age_45_64   544.7199 597.7951 91.4850
expected_age_65_plus 346.9610 380.7674 58.2717</code></pre>
</div>
</div>
<p>The difference between each observed and expected value is the <em>residual</em>. Save all the residuals in a table called <code>residual_table</code>:</p>
</section>
<section id="replace-this-line-with-your-code-1" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code-1">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>residual_table <span class="ot">&lt;-</span> observed_table <span class="sc">-</span> expected_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For each cell, square the residual and divide it by its expected frequency:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chi2_table <span class="ot">&lt;-</span> (residual_table<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>expected_table</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(chi2_table, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            biden trump other
age_18_29   1.245 0.813 0.175
age_30_44   0.269 0.371 7.972
age_45_64   1.311 3.269 3.342
age_65_plus 0.938 0.653 0.089</code></pre>
</div>
</div>
<p>The test statistic is the sum of all the cells’ chi-squared values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(chi2_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.44442</code></pre>
</div>
</div>
<p>For this test, the degrees of freedom are calculated as: (# of rows - 1)(# of columns - 1)</p>
<p>So in the ageXcandidate table, the degrees of freedom are…</p>
</section>
<section id="replace-this-line-with-your-code-2" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code-2">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4-1</span>) <span class="sc">*</span> (<span class="dv">3-1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>To find the cutoff for the critical region, use <code>qchisq()</code> with the degrees of freedom:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(.<span class="dv">95</span>, <span class="at">df =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.59159</code></pre>
</div>
</div>
<p>With df=6, need a chi-square test statistic at least as big as 12.59159 to reject the null hypothesis. With our test statistic of 20.444, we can reject the null hypothesis that the two variables are independent. That means there is a significant association between them.</p>
<p>To convert the test statistic to a p-value, use 1 - pchisq() with the degrees of freedom:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(<span class="fl">20.444</span>, <span class="at">df =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002307742</code></pre>
</div>
</div>
</section>
</section>
<section id="shortut-in-r" class="level2">
<h2 class="anchored" data-anchor-id="shortut-in-r">Shortut in R</h2>
<p>R can do all of this with the built-in <code>chisq.test()</code> function, which requires either a table of frequencies or the two variable names (like <code>born</code> and <code>opclout</code> from Assignment 5). In this example, we can use our saved table of frequencies:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(observed_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  observed_table
X-squared = 20.444, df = 6, p-value = 0.002307</code></pre>
</div>
</div>
<p>We now know how the X-squared test statistic relates to the df value and the p-value. For a 95% confidence test, compare the p-value to .05. In this example, we can reject the null hypothesis that age and candidate preference are independent. Age is significantly associated with candidate preference.</p>
</section>
<section id="another-example" class="level2">
<h2 class="anchored" data-anchor-id="another-example">Another example</h2>
<p>Is there a significant association at the 99% confidence level between state and belief that “Joe Biden is just too old to be an effective president”? We’ll leave out Nevada for this exercise.</p>
<section id="replace-this-line-with-your-code-3" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code-3">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>az <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">47</span>, .<span class="dv">23</span>, .<span class="dv">13</span>, .<span class="dv">15</span>, .<span class="dv">03</span>)<span class="sc">*</span><span class="dv">603</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ga <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">24</span>, .<span class="dv">13</span>, .<span class="dv">14</span>, .<span class="dv">04</span>)<span class="sc">*</span><span class="dv">629</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>mi <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">46</span>, .<span class="dv">25</span>, .<span class="dv">13</span>, .<span class="dv">14</span>, .<span class="dv">03</span>)<span class="sc">*</span><span class="dv">616</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>pa <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">24</span>, .<span class="dv">16</span>, .<span class="dv">13</span>, .<span class="dv">01</span>)<span class="sc">*</span><span class="dv">600</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>wi <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">27</span>, .<span class="dv">15</span>, .<span class="dv">12</span>, .<span class="dv">01</span>)<span class="sc">*</span><span class="dv">603</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">rbind</span>(az, ga, mi, pa, wi)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(states) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Strongly Agree"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Somewhat Agree"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Somewhat Disagree"</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Strongly Disagree"</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"DK/Refused"</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">round</span>(states, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  states
X-squared = 26.301, df = 16, p-value = 0.04994</code></pre>
</div>
</div>
<p>That p-value is so close to .05! Look at the table again. Could it be that the “DK/Refused” responses are overinflating the dependence between state and response? Run the test on a table that does not include that column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(states[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="co"># include all rows, and columns 1:4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  states[, 1:4]
X-squared = 8.0897, df = 12, p-value = 0.7781</code></pre>
</div>
</div>
</section>
</section>
<section id="extra" class="level2">
<h2 class="anchored" data-anchor-id="extra">Extra</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>az <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">47</span>, .<span class="dv">23</span>, .<span class="dv">13</span>, .<span class="dv">15</span>, .<span class="dv">03</span>)<span class="sc">*</span><span class="dv">603</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>ga <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">24</span>, .<span class="dv">13</span>, .<span class="dv">14</span>, .<span class="dv">04</span>)<span class="sc">*</span><span class="dv">629</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>mi <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">46</span>, .<span class="dv">25</span>, .<span class="dv">13</span>, .<span class="dv">14</span>, .<span class="dv">03</span>)<span class="sc">*</span><span class="dv">616</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>pa <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">24</span>, .<span class="dv">16</span>, .<span class="dv">13</span>, .<span class="dv">01</span>)<span class="sc">*</span><span class="dv">600</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>wi <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">27</span>, .<span class="dv">15</span>, .<span class="dv">12</span>, .<span class="dv">01</span>)<span class="sc">*</span><span class="dv">603</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">rbind</span>(az, ga, mi, pa, wi)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(states) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Strongly Agree"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Somewhat Agree"</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Somewhat Disagree"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Strongly Disagree"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"DK/Refused"</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">round</span>(states, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>