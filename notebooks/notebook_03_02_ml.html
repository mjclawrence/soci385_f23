<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week Three, Class Two</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="notebook_03_02_ml_files/libs/clipboard/clipboard.min.js"></script>
<script src="notebook_03_02_ml_files/libs/quarto-html/quarto.js"></script>
<script src="notebook_03_02_ml_files/libs/quarto-html/popper.min.js"></script>
<script src="notebook_03_02_ml_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="notebook_03_02_ml_files/libs/quarto-html/anchor.min.js"></script>
<link href="notebook_03_02_ml_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="notebook_03_02_ml_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="notebook_03_02_ml_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="notebook_03_02_ml_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="notebook_03_02_ml_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week Three, Class Two</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="getting-started" class="level1">
<h1>Getting Started</h1>
<p>We are still using the <code>gss_week3</code> dataset, and we will be using <code>tidyverse</code> packages. Reload the data and <code>tidyverse</code> if you are starting a new notebook.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>gss_week3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/mjclawrence/soci385_f23/main/data/gss_week3.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="more-than-two-categories" class="level1">
<h1>More Than Two Categories</h1>
<p>New variables can have more than two categories. Their values can also be characters rather than numbers. In this example, we’ll create a new variable called <code>edcat</code> that puts years of education into the following education categories: “Less Than HS”, “HS Diploma”, “Some College”, “College Degree”, and “Grad Prof Degree”. How should we cut the values of the <code>educ</code> variable to make these categories?</p>
<p>Even though we are creating more than two categories, we can still use <code>ifelse()</code> to set them up. The trick is that each “else” condition will open another <code>ifelse()</code> function until we are ready to assign remaining observations to the last category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gss_week3 <span class="ot">&lt;-</span> gss_week3 <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">edcat =</span> <span class="fu">ifelse</span>(educ <span class="sc">&lt;</span> <span class="dv">12</span>, <span class="st">"Less Than HS"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(educ <span class="sc">==</span> <span class="dv">12</span>, <span class="st">"HS Diploma"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(educ <span class="sc">%in%</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>, <span class="st">"Some College"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">ifelse</span>(educ <span class="sc">==</span> <span class="dv">16</span>, <span class="st">"College Degree"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"Grad Prof Degree"</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The use of <code>%in%</code> for the “Some College” group is new. That’s a helpful tool for capturing values within a range.</p>
<p>What proportion of respondents is in each education category?</p>
<section id="replace-this-line-with-your-code" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(gss_week3<span class="sc">$</span>edcat)),<span class="dv">3</span>),<span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      HS Diploma     Some College     Less Than HS   College Degree 
           0.292            0.250            0.166            0.159 
Grad Prof Degree 
           0.133 </code></pre>
</div>
</div>
<p>The next step is to tell R we will be using this new variable as a factor variable. We do this using <code>mutate()</code> as well. We also need to assert the order of the categories (from lowest to highest), since by default the categories are listed alphabetically. To assert the order, we will add the <code>levels = c()</code> option. We don’t need to use the <code>labels = c()</code> option this time because our values already have character names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gss_week3 <span class="ot">&lt;-</span> gss_week3  <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">edcat =</span> <span class="fu">factor</span>(edcat,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Less Than HS"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"HS Diploma"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Some College"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"College Degree"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Grad Prof Degree"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s get a sense of how the distribution of age at first birth varies by education by overlaying density plots of <code>agekdbrn</code> for each level of <code>edcat</code>. Set everything up in ggplot2 the same way as before (but adjust the title as appropriate). Use <code>edcat</code> for our color option so each level of edcat gets a density plot in a different color.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gss_week3, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">aes</span>(<span class="at">x =</span> agekdbrn, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> edcat))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age at First Birth"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Distribution of Age at First Birth by Highest Degree"</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">"GSS, 2012-2021"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_03_02_ml_files/figure-html/agekdbrn%20plot%20by%20edcat-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Another way to change the title of the legend is to add <code>color =</code> to the <code>labs()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gss_week3, <span class="fu">aes</span>(<span class="at">x =</span> agekdbrn, <span class="at">color =</span> edcat))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age at </span><span class="sc">\n</span><span class="st">First Birth"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of Age at First Birth by Highest Degree"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"GSS, 2012-2021"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Highest Degree"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_03_02_ml_files/figure-html/agekdbrn%20edcat%20plot%20legend%20title-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="facets-if-there-is-time" class="level2">
<h2 class="anchored" data-anchor-id="facets-if-there-is-time">Facets (If There Is Time)</h2>
<p>The overlapping plots are quite effective in this case. That’s not always true. Another option would be to have a separate plot for each category. You can do that with faceting. In this example, we want to facet into <em>rows</em> with <code>edcat~.</code>. Note that with faceting you don’t need a legend anymore. You can delete it using <code>guides(color="none")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gss_week3, <span class="fu">aes</span>(<span class="at">x =</span> agekdbrn, <span class="at">color =</span> edcat))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age at First Birth"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of Age at First Birth by Highest Degree"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"GSS, 2012-2021"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_grid</span>(edcat<span class="sc">~</span>.) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">color=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_03_02_ml_files/figure-html/agekdbrn%20edcat%20plot%20with%20row%20facet-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="delete-from-class-notebook" class="level1">
<h1>Delete from class notebook</h1>
<p>To change size of text in label “strips”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gss_week3, <span class="fu">aes</span>(<span class="at">x =</span> agekdbrn, <span class="at">color =</span> edcat))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age at First Birth"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of Age at First Birth by Highest Degree"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"GSS, 2012-2021"</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_grid</span>(edcat<span class="sc">~</span>.) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">color=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_03_02_ml_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can facet into columns by replacing <code>edcat~.</code> with <code>.~edcat</code>. Which would make more sense in this case?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gss_week3, <span class="fu">aes</span>(<span class="at">x =</span> agekdbrn, <span class="at">color =</span> edcat))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>agekdbrn_edcat_plot <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age at First Birth"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of Age at First Birth by Highest Degree"</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"GSS, 2012-2021"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_grid</span>(.<span class="sc">~</span>edcat)  <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">color=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_03_02_ml_files/figure-html/agekdbrn%20edcat%20plot%20with%20column%20facet-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Good rule of thumb: faceting by rows is better when comparing the x axis and faceting by columns is better when comparing the y axis.</p>
</section>
<section id="back-to-basics" class="level1">
<h1>Back to Basics</h1>
<p>Let’s take a break from graphics for a moment and think about tables and basic summaries again. If you wanted to find the proportion of respondents in each education category for a specific race/ethnicity category (use the <code>racehisp</code> variable), what might you do?</p>
<section id="replace-this-line-with-your-code-1" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code-1">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(gss_week3<span class="sc">$</span>edcat</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                 [gss_week3<span class="sc">$</span>racehisp<span class="sc">==</span><span class="st">"Black"</span>])),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Less Than HS       HS Diploma     Some College   College Degree 
                                                                    
Grad Prof Degree 
                 </code></pre>
</div>
</div>
<p>Another option would be a cross-tabulation. We set up a cross-tabulation using the same syntax as the <code>table()</code> function, but now we’ll have two variables separated by a comma. The values of our first variable will become the rows in the table, and the values of the second variable will become the columns. This ordering matters! Think of the row variable as your independent variable (the X) and the column as your dependent variable (the Y). If that’s the setup, why would we want the values of <code>racehisp</code> to become the rows in this table and the values of <code>edcat</code> to become the columns?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gss_week3<span class="sc">$</span>racehisp, gss_week3<span class="sc">$</span>edcat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Less Than HS HS Diploma Some College College Degree Grad Prof Degree
  black             214        321          350            139               91
  hispanic          372        289          212             78               69
  other              42         48           64             67               56
  white             525       1369         1113            817              709</code></pre>
</div>
</div>
<p>How do you think you make a cross-tabulation with proportions?</p>
</section>
<section id="replace-this-line-with-your-code-2" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code-2">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(gss_week3<span class="sc">$</span>racehisp, gss_week3<span class="sc">$</span>edcat)),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Less Than HS HS Diploma Some College College Degree Grad Prof Degree
  black           0.031      0.046        0.050          0.020            0.013
  hispanic        0.054      0.042        0.031          0.011            0.010
  other           0.006      0.007        0.009          0.010            0.008
  white           0.076      0.197        0.160          0.118            0.102</code></pre>
</div>
</div>
<p>By default, these proportions are for the entire table. So the top left cell tells us that 3% of all the cases in this data frame are Black respondents who did not complete high school.</p>
<p>To get row proportions, add a comma and a 1 (since the first variable in our table command is the row variable) before closing the prop.table parentheses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(gss_week3<span class="sc">$</span>racehisp, gss_week3<span class="sc">$</span>edcat),<span class="dv">1</span>),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Less Than HS HS Diploma Some College College Degree Grad Prof Degree
  black           0.192      0.288        0.314          0.125            0.082
  hispanic        0.365      0.283        0.208          0.076            0.068
  other           0.152      0.173        0.231          0.242            0.202
  white           0.116      0.302        0.246          0.180            0.156</code></pre>
</div>
</div>
<p>Each <em>row</em> in the above table sums to 1. To get column proportions, replace the 1 with a 2. In the table below, each <em>column</em> should sum to 1. In general, we’ll use row proportions more than column proportions.</p>
</section>
<section id="replace-this-line-with-your-code-3" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code-3">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(gss_week3<span class="sc">$</span>racehisp, gss_week3<span class="sc">$</span>edcat),<span class="dv">2</span>),<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Less Than HS HS Diploma Some College College Degree Grad Prof Degree
  black           0.186      0.158        0.201          0.126            0.098
  hispanic        0.323      0.143        0.122          0.071            0.075
  other           0.036      0.024        0.037          0.061            0.061
  white           0.455      0.675        0.640          0.742            0.766
  Sum             1.000      1.000        1.000          1.000            1.000
          
             Sum
  black    0.769
  hispanic 0.734
  other    0.219
  white    3.278
  Sum      5.000</code></pre>
</div>
</div>
<p>We have seen other functions that help with finding values of one variable for all values of another variable. For example, we might want to find the mean age at first birth for each race/ethnicity category. To do so, we first group all the observations by the categorical variable. Then we create a variable that summarizes one variable for all the categories of our other variable. And we can connect these functions with pipes. To use the output from this summary, we’ll save the output in a new dataframe named <code>agekdbrn_summary</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_summary <span class="ot">&lt;-</span> gss_week3 <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">group_by</span>(racehisp) <span class="sc">|&gt;</span>  <span class="co"># We want info about each level of this variable</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">summarise</span>(<span class="at">mean_agekdbrn =</span> <span class="fu">round</span>(<span class="fu">mean</span>(agekdbrn),<span class="dv">2</span>)) <span class="co"># The info we want</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>agekdbrn_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  racehisp mean_agekdbrn
  &lt;chr&gt;            &lt;dbl&gt;
1 black             22.0
2 hispanic          23.0
3 other             25.2
4 white             25.1</code></pre>
</div>
</div>
<p>This <code>summarise()</code> function works with a lot of the basic commands we have discussed (min, max, sd, var, etc.). Try finding the median age at first birth for each education category. You can still use the <code>agekdbrn_summary</code> object:</p>
</section>
<section id="replace-this-line-with-your-code-4" class="level3">
<h3 class="anchored" data-anchor-id="replace-this-line-with-your-code-4">REPLACE THIS LINE WITH YOUR CODE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_summary <span class="ot">&lt;-</span> gss_week3 <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(edcat)  <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_agekdbrn =</span> <span class="fu">median</span>(agekdbrn))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>agekdbrn_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  edcat            median_agekdbrn
  &lt;fct&gt;                      &lt;int&gt;
1 Less Than HS                  20
2 HS Diploma                    22
3 Some College                  23
4 College Degree                27
5 Grad Prof Degree              28</code></pre>
</div>
</div>
<p>Let’s end with a plot visualizing the distribution of median age at first birth by education level.</p>
<p>For this plot, we have an x axis variable (<code>edcat</code>) and a y axis variable (<code>median_agekdbrn</code>). We want something that looks like the output from <code>geom_barplot()</code>, but we use <code>geom_col()</code> when we have both x and y variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_col <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agekdbrn_summary, <span class="fu">aes</span>(<span class="at">x =</span> edcat, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> median_agekdbrn,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">fill =</span> edcat))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>agekdbrn_col <span class="sc">+</span> <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Median Age"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Median Age at First Birth by Education"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"GSS, 2012-2021"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Highest Degree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_03_02_ml_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With column labels…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>agekdbrn_col <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agekdbrn_summary, <span class="fu">aes</span>(<span class="at">x =</span> edcat, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> median_agekdbrn,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">fill =</span> edcat))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>agekdbrn_col <span class="sc">+</span> <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Median Age"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Median Age at First Birth by Education"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"GSS, 2012-2021"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Highest Degree"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> median_agekdbrn),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">5</span>) <span class="co"># Moves the labels above the columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_03_02_ml_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>